#===============================================================================
#  HYTALE SERVER - CONFIGURATION PRINCIPALE
#  Toutes les variables configurables sont centralis√©es ici
#===============================================================================

#===============================================================================
#  CHEMINS
#===============================================================================

# R√©pertoire d'installation (modifi√© automatiquement par setup-hytale.sh)
INSTALL_DIR="__INSTALL_DIR__"

# Langue des messages (fr = Fran√ßais, en = English)
LANG_CODE="fr"

# Sous-r√©pertoires (relatifs √† INSTALL_DIR si non absolus)
SERVER_DIR="${INSTALL_DIR}/server"
ASSETS_DIR="${INSTALL_DIR}/assets"
BACKUPS_DIR="${INSTALL_DIR}/backups"
LOGS_DIR="${INSTALL_DIR}/logs"
CONFIG_DIR="${INSTALL_DIR}/config"

# Fichiers du serveur
SERVER_JAR="HytaleServer.jar"
ASSETS_FILE="Assets.zip"

#===============================================================================
#  SERVEUR HYTALE
#===============================================================================

# Nom de la session screen
SCREEN_NAME="hytale"

# Nom du serveur (utilis√© dans les notifications Discord et la config serveur)
SERVER_NAME="Hytale Server"

# Nombre maximum de joueurs
MAX_PLAYERS=20

# Adresse et port d'√©coute (UDP, protocole QUIC)
BIND_ADDRESS="0.0.0.0:5520"

# Mode d'authentification: authenticated | offline
AUTH_MODE="authenticated"

# Canal de t√©l√©chargement: release | pre-release
PATCHLINE="release"

#===============================================================================
#  JAVA
#===============================================================================

# Chemin vers l'ex√©cutable Java (laisser vide pour utiliser java du PATH)
# Exemple: "/usr/lib/jvm/temurin-25-jdk-amd64/bin/java"
JAVA_PATH=""

# Version minimum requise
JAVA_MIN_VERSION=25

# Options JVM
JAVA_OPTS="-Xms4G -Xmx8G -XX:+UseG1GC -XX:+ParallelRefProcEnabled -XX:MaxGCPauseMillis=200"

# Utiliser le cache AOT si disponible (am√©liore le temps de d√©marrage)
USE_AOT_CACHE="true"

#===============================================================================
#  BACKUP
#===============================================================================

# Activer le backup int√©gr√© Hytale
ENABLE_BUILTIN_BACKUP="true"

# Fr√©quence du backup int√©gr√© (minutes)
BACKUP_FREQUENCY=30

# Nombre maximum de backups manuels √† conserver
MAX_BACKUPS=7

# Pr√©fixe des fichiers de backup
BACKUP_PREFIX="hytale_backup"

# Utiliser pigz pour des backups plus rapides (si install√©)
USE_PIGZ="true"

#===============================================================================
#  LOGS
#===============================================================================

# Dur√©e de r√©tention des logs archiv√©s (jours)
LOG_RETENTION_DAYS=7

#===============================================================================
#  ESPACE DISQUE
#===============================================================================

# Espace disque minimum requis (GB)
# Le serveur refuse de d√©marrer/backup si l'espace est insuffisant
MIN_DISK_SPACE_GB=5

#===============================================================================
#  WATCHDOG
#===============================================================================

# Activer le watchdog (red√©marrage automatique en cas de crash)
WATCHDOG_ENABLED="true"

#===============================================================================
#  SYSTEMD (pour les fichiers .service et .timer)
#===============================================================================

# Utilisateur syst√®me
HYTALE_USER="hytale"
HYTALE_GROUP="hytale"

# Fr√©quence du timer de backup (format systemd OnCalendar)
# Exemples: "*-*-* 00/6:00:00" (toutes les 6h), "daily" (quotidien)
BACKUP_TIMER_SCHEDULE="*-*-* 00/6:00:00"

# D√©lai apr√®s le boot pour le premier backup (secondes)
BACKUP_BOOT_DELAY="5min"

#===============================================================================
#  T√âL√âCHARGEMENT (update.sh)
#===============================================================================

# URL du downloader officiel
DOWNLOADER_URL="https://downloader.hytale.com/hytale-downloader.zip"

#===============================================================================
#  RESTART AUTOMATIQUE
#===============================================================================

# Activer le restart automatique planifi√©
ENABLE_AUTO_RESTART="true"

# Heures de restart automatique (format 24h, s√©par√©es par espaces)
# Exemples:
#   "06:00"                    ‚Üí 1 restart √† 6h du matin
#   "06:00 18:00"              ‚Üí 2 restarts √† 6h et 18h
#   "00:00 06:00 12:00 18:00"  ‚Üí 4 restarts toutes les 6 heures
AUTO_RESTART_TIMES="06:00 18:00"

# D√©lais d'annonce avant restart (secondes, s√©par√©es par espaces)
# Les joueurs recevront un message /say √† chaque palier
RESTART_WARNINGS="300 60 30 10 5"

#===============================================================================
#  MISE √Ä JOUR AUTOMATIQUE
#===============================================================================

# V√©rifier et installer les mises √† jour avant chaque restart automatique
AUTO_UPDATE_ON_RESTART="true"

# Messages d'annonce (le %s sera remplac√© par le temps restant)
MSG_RESTART_WARNING="‚ö†Ô∏è ATTENTION: Le serveur red√©marrera dans %s!"
MSG_RESTART_NOW="üîÑ Le serveur red√©marre maintenant... √Ä tout de suite!"
MSG_UPDATE_AVAILABLE="üì¶ Une mise √† jour a √©t√© d√©tect√©e et sera install√©e."
MSG_NO_UPDATE="‚úÖ Serveur d√©j√† √† jour."
